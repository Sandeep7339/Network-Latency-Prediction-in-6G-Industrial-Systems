# Explainability & Error Analysis Report


## 1  Regression Performance on Test Set


| Metric | Value |
|--------|-------|
| MAE | 12.1088 |
| RMSE | 15.1519 |
| R2 | -0.0039 |

## 2  Classification Performance on Test Set


| Metric | Value |
|--------|-------|
| Accuracy | 0.8928 |
| AUC | 0.5052 |

## 3  Feature Importances (mean |SHAP|)


| Rank | Feature | Mean |SHAP| |
|------|---------|-------------|
| 1 | num__packet_rate_60s | 0.023027 |
| 2 | onehot__vendor_Bosch | 0.019679 |
| 3 | onehot__attack_type_Data Injection | 0.018819 |
| 4 | num__latency_lag_3 | 0.017536 |
| 5 | freq__firmware_version_freq | 0.017467 |
| 6 | onehot__traffic_type_Sensor | 0.017423 |
| 7 | onehot__vendor_Rockwell | 0.017396 |
| 8 | num__packet_rate_1s | 0.017253 |
| 9 | num__latency_lag_6 | 0.017012 |
| 10 | onehot__attack_type_DoS | 0.016892 |
| 11 | num__latency_lag_8 | 0.016851 |
| 12 | num__latency_roll_std_1s | 0.016796 |
| 13 | freq__src_device_id_freq | 0.016749 |
| 14 | num__packet_rate_10s | 0.016704 |
| 15 | num__latency_lag_7 | 0.016520 |
| 16 | num__latency_lag_10 | 0.016509 |
| 17 | num__latency_lag_2 | 0.016470 |
| 18 | num__control_action_delay_us | 0.016253 |
| 19 | num__latency_roll_mean_1s | 0.016229 |
| 20 | num__latency_lag_5 | 0.016183 |

## 4  SHAP Visualisations


- **Global summary**: `figures/shap_summary.png` — bar chart of the top-20 features ranked by mean |SHAP|.
- **Dependence plots**: `figures/shap_dependence_*.png` — shows how each top feature's value relates to its SHAP contribution.
- **Per-device plots**: `figures/shap_device_*.png` — device-level importance breakdowns for the 5 most frequent devices.

## 5  Error Analysis


- **Confusion matrix**: `figures/confusion_matrix.png` — raw counts and normalised view.
- **Error histograms**: `figures/error_histogram_regression.png` — residual distribution + predicted vs true scatter.
- **Classification probabilities**: `figures/error_histogram_classification.png` — probability by class + calibration curve.

## 6  Worst-Case Traces


10 worst-case samples saved under `figures/case_studies/`.
Each plot shows top-10 feature values (left) and a ±10 sample context window (right).

### Observations


- The synthetic dataset has uniform-random features with no true signal, so SHAP values are near-zero and predictions are near-mean.
- The confusion matrix reflects the base-rate (~9 % violation) — the model tends to predict the majority class.
- Worst-case errors correspond to extreme true latency values that lie far from the population mean, which the model cannot predict without exploitable signal.

---
*Report auto-generated by `src.eval.error_analysis`.*